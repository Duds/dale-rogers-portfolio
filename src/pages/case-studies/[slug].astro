---
/* This is the dynamic case study template that will render individual case studies */
import { getCollection, type CollectionEntry } from "astro:content";
import CaseStudyLayout from "@/layouts/CaseStudyLayout.astro";

/* Insert type definition for case studies */
interface CaseStudyEntry {
  slug: string;
  body: string;
  data: {
    title: string;
    description: string;
  };
}

// Add prerender directive to generate static pages
export const prerender = true;

// Define what paths to be prerendered
export async function getStaticPaths() {
  const caseStudies = await getCollection("case-studies");
  return caseStudies.map((caseStudy) => ({
    params: { slug: caseStudy.slug },
    props: { caseStudy },
  }));
}

interface Props {
  caseStudy: CollectionEntry<"case-studies">;
}

const { caseStudy } = Astro.props;
const { Content } = await caseStudy.render();

if (!caseStudy) {
  throw new Error(`Case study not found for slug: ${caseStudy.slug}`);
}
---

<CaseStudyLayout caseStudy={caseStudy}>
  <Content />
</CaseStudyLayout>
