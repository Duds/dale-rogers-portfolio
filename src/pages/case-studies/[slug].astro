---
/* This is the dynamic case study template that will render individual case studies */
import { getCollection } from "astro:content";

/* Insert type definition for case studies */
interface CaseStudyEntry {
  slug: string;
  body: string;
  data: {
    title: string;
    description: string;
  };
}

// Define what paths to be prerendered
export async function getStaticPaths() {
  const caseStudies = (await getCollection(
    "case-studies" as any
  )) as unknown as Array<{
    slug: string;
  }>;
  return caseStudies.map((study) => ({ params: { slug: study.slug } }));
}

const { slug } = Astro.params;
const caseStudies = (await getCollection(
  "case-studies" as any
)) as unknown as Array<CaseStudyEntry>;
const caseStudy = caseStudies.find((study) => study.slug === slug);

if (!caseStudy) {
  throw new Error(`Case study not found for slug: ${slug}`);
}
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{caseStudy.data.title}</title>
  </head>
  <body class="bg-gray-50 text-gray-900">
    <main class="container mx-auto py-10 px-4">
      <h1 class="text-4xl font-bold mb-4">{caseStudy.data.title}</h1>
      <p class="mb-6">{caseStudy.data.description}</p>
      <article class="prose max-w-none">
        {caseStudy.body}
      </article>
    </main>
  </body>
</html>
