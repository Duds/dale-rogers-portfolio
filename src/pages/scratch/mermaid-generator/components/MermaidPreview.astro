---
import { Minus, Plus } from 'lucide-astro';
---

<div class="mermaid-preview">
  <div class="section-title">Preview</div>
  <div class="mermaid-container">
    <div class="mermaid-wrapper">
      <div id="mermaid-output"></div>
    </div>
    <div class="zoom-controls">
      <button onclick="window.zoomOut()" title="Zoom Out" class="zoom-button">
        <Minus class="w-5 h-5" />
      </button>
      <input
        type="range"
        class="zoom-slider"
        min="50"
        max="200"
        value="100"
        step="10"
      />
      <span class="zoom-value">100%</span>
      <button onclick="window.zoomIn()" title="Zoom In" class="zoom-button">
        <Plus class="w-5 h-5" />
      </button>
    </div>
  </div>
</div>

<style>
  @reference "tailwindcss";

  .mermaid-preview {
    @apply w-full;
  }

  .section-title {
    @apply text-lg font-medium text-gray-900 dark:text-gray-100 mb-4;
  }

  .mermaid-container {
    @apply relative bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden min-h-[300px];
  }

  .mermaid-wrapper {
    @apply p-4 overflow-auto max-h-[600px];
  }

  #mermaid-output {
    @apply flex justify-center items-center min-h-[200px];
  }

  .zoom-controls {
    @apply flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700;
  }

  .zoom-button {
    @apply p-1 bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full transition-colors;
  }

  .zoom-button svg {
    @apply w-5 h-5;
  }

  .zoom-slider {
    @apply flex-1 h-1 bg-gray-200 dark:bg-gray-700 rounded-full appearance-none;
    @apply [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:bg-blue-600 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer;
    @apply [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:bg-blue-600 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:border-0;
  }

  .zoom-value {
    @apply text-sm text-gray-600 dark:text-gray-400 min-w-[48px] text-center;
  }
</style>

<script>
  import { setupPreview } from "../shared/core/preview.js";

  // Initialize preview when component is mounted
  document.addEventListener("DOMContentLoaded", () => {
    setupPreview();
  });
</script>
